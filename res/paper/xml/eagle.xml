<paper>

	<title>The EAGLE project</title>
	
	<subtitle>Simulating the evolution and assembly of galaxies and their environments</subtitle>

	<author>
		Joop Schaye, Robert A. Crain, Richard G. Bower, Michelle Furlong, Matthieu Schaller, Tom Theuns, Claudio Dalla Vecchia, Carlos S. Frenk, I. G. McCarthy, John C. Helly, Adrian Jenkins, Y. M. Rosas-Guevara, Simon D. M. White, Maarten Baes, C. M. Booth, Peter Camps, Julio F. Navarro, Yan Qu, Alireza Rahmati, Till Sawala, Peter A. Thomas, James Trayford
	</author>

	<abstruct>
		We introduce the Virgo Consortium’s EAGLE project, a suite of hydrodynamical simulations that follow the formation of galaxies and supermassive black holes in cosmologically representative volumes of a standard ΛCDM universe. We discuss the limitations of such simulations in light of their finite resolution and poorly constrained subgrid physics, and how these affect their predictive power. One major improvement is our treatment of feedback from massive stars and AGN in which thermal energy is injected into the gas without the need to turn off cooling or decouple hydrodynam- ical forces, allowing winds to develop without predetermined speed or mass loading factors. Because the feedback efficiencies cannot be predicted from first principles, we calibrate them to the present-day galaxy stellar mass function and the amplitude of the galaxy-central black hole mass relation, also taking galaxy sizes into account. The observed galaxy stellar mass function is reproduced to <∼0.2 dex over the full resolved mass range, 108 < M∗ /M⊙ <∼ 1011 , a level of agreement close to that at- tained by semi-analytic models, and unprecedented for hydrodynamical simulations.
		We compare our results to a representative set of low-redshift observables not con- sidered in the calibration, and find good agreement with the observed galaxy specific star formation rates, passive fractions, Tully-Fisher relation, total stellar luminosities of galaxy clusters, and column density distributions of intergalactic Civ and Ovi. While the mass-metallicity relations for gas and stars are consistent with observations for M∗ >∼ 109 M⊙ (M∗ >∼ 1010 M⊙ at intermediate resolution), they are insufficiently steep at lower masses. For the reference model the gas fractions and temperatures are too high for clusters of galaxies, but for galaxy groups these discrepancies can be resolved by adopting a higher heating temperature in the subgrid prescription for AGN feedback. The EAGLE simulation suite, which also includes physics variations and higher-resolution zoomed-in volumes described elsewhere, constitutes a valuable new resource for studies of galaxy formation
	</abstruct>

	<body>
	1 INTRODUCTION
	Cosmological simulations have greatly improved our under- standing of the physics of galaxy formation and are widely used to guide the interpretation of observations and the de- sign of new observational campaigns and instruments. Sim- ulations enable astronomers to “turn the knobs” much as experimental physicists are able to in the laboratory. While such numerical experiments can be valuable even if the sim- ulations fail to reproduce observations, in general our con- fidence in the conclusions drawn from simulations, and the number of applications they can be used for, increases with the level of agreement between the best-fit model and the observations.
	For many years the overall agreement between hydrody- namical simulations and observations of galaxies was poor. Most simulations produced galaxy mass functions with the wrong shape and normalisation, the galaxies were too mas- sive and too compact, and the stars formed too early. Star formation in high-mass galaxies was not quenched and the models could not simultaneously reproduce the stellar masses and the thermodynamic properties of the gas in groups and clusters (e.g. Scannapieco et al. 2012 and ref- erences therein).

	Driven in part by the failure of hydrodynamical sim- ulations to reproduce key observations, semi-analytic and halo-based models have become the tools of choice for de- tailed comparisons between galaxy surveys and theory (see Baugh 2006 and Cooray & Sheth 2002 for reviews). Thanks to their flexibility and relatively modest computational ex- pense, these approaches have proven valuable for many pur- poses. Examples include the interpretation of observations of galaxies within the context of the cold dark matter frame- work, relating galaxy populations at different redshifts, the creation of mock galaxy catalogues to investigate selection effects or to translate measurements of galaxy clustering into information concerning the occupation of dark matter haloes by galaxies.

	However, hydrodynamical simulations have a number of important advantages over these other approaches. The risk that a poor or invalid approximation may lead to over- confidence in an extrapolation, interpretation or application of the model is potentially smaller, because they do not need to make as many simplifying assumptions. Although the subgrid models employed by current hydrodynamical simulations often resemble the ingredients of semi-analytic models, there are important parts of the problem for which subgrid models are no longer required. Since hydrodynami- cal simulations evolve the dark matter and baryonic compo- nents self-consistently, they automatically include the back- reaction of the baryons on the collisionless matter, both in- side and outside of haloes. The higher resolution description of the baryonic component provided by hydrodynamical sim- ulations also enables one to ask more detailed questions and to compare with many more observables. Cosmological hy- drodynamical simulations can be used to model galaxies and the intergalactic medium (IGM) simultaneously, including the interface between the two, which may well be critical to understanding the fuelling and feedback cycles of galaxies.
	The agreement between hydrodynamical simulations of galaxy formation and observations has improved signifi- cantly in recent years. Simulations of the diffuse IGM al-
	ready broadly reproduced quasar absorption line observa- tions of the Lyα forest two decades ago (e.g. Cen et al. 1994; Zhang et al. 1995; Hernquist et al. 1996; Theuns et al. 1998; Dav ́e et al. 1999). The agreement is sufficiently good that comparisons between theory and observation can be used to measure cosmological and physical parameters (e.g. Croft et al. 1998; Schaye et al. 2000; Viel et al. 2004; McDonald et al. 2005). More recently, simulations that have been re- processed using radiative transfer of ionizing radiation have succeeded in matching key properties of the high-column density H i absorbers (e.g. Pontzen et al. 2008; Altay et al. 2011; McQuinn et al. 2011; Rahmati et al. 2013a).
	Reproducing observations of galaxies and the gas in clusters of galaxies has proven to be more difficult than matching observations of the low-density IGM, but several groups have now independently succeeded in producing disc galaxies with more realistic sizes and masses (e.g. Gover- nato et al. 2004, 2010; Okamoto et al. 2005; Agertz et al. 2011; Guedes et al. 2011; McCarthy et al. 2012; Brook et al. 2012; Stinson et al. 2013; Munshi et al. 2013; Aumer et al. 2013; Hopkins et al. 2013; Vogelsberger et al. 2013, 2014b; Marinacci et al. 2014). For the thermodynamic properties of groups and clusters of galaxies the progress has also been rapid (e.g. Puchwein et al. 2008; McCarthy et al. 2010; Fab- jan et al. 2010; Le Brun et al. 2014). The improvement in the realism of the simulated galaxies has been accompanied by better agreement between simulations and observations of the metals in circumgalactic and intergalactic gas (e.g. Stinson et al. 2012; Oppenheimer et al. 2012), which sug- gests that a more appropriate description of galactic winds may have been responsible for much of the progress.
	Indeed, the key to the increase in the realism of the sim- ulated galaxies has been the use of subgrid models for feed- back from star formation that are more effective in generat- ing galactic winds and, at the high-mass end, the inclusion of subgrid models for feedback from active galactic nuclei (AGN). The improvement in the resolution afforded by in- creases in computing power and code efficiency has also been important, but perhaps mostly because higher resolution has helped to make the implemented feedback more efficient by reducing spurious, numerical radiative losses. Improvements in the numerical techniques to solve the hydrodynamics have also been made (e.g. Price 2008; Springel 2010; Read et al. 2010; Saitoh & Makino 2013; Hopkins 2013) and may even be critical for particular applications (e.g. Agertz et al. 2007; Bauer & Springel 2012), but overall their effect appears to be small compared to reasonable variations in subgrid models for feedback processes (Scannapieco et al. 2012).
	Here we present the EAGLE project1, which stands for Evolution and Assembly of GaLaxies and their Environ- ments. EAGLE consists of a suite of cosmological, hydro- dynamical simulations of a standard ΛCDM universe. The main models were run in volumes of 25 to 100 comoving Mpc (cMpc) on a side and employ a resolution that is suf- ficient to marginally resolve the Jeans scales in the warm (T ∼ 104 K) interstellar medium (ISM). The simulations use state-of-the-art numerical techniques and subgrid models for radiative cooling, star formation, stellar mass loss and metal enrichment, energy feedback from star formation, gas accre- tion onto, and mergers of, supermassive black holes (BHs), and AGN feedback. The efficiency of the stellar feedback and the BH accretion were calibrated to broadly match the observed z ∼ 0 galaxy stellar mass function (GSMF) subject to the constraint that the galaxy sizes must also be reason- able, while the efficiency of the AGN feedback was calibrated to the observed relation between stellar mass and BH mass. The goal was to reproduce these observables using, in our opinion, simpler and more natural prescriptions for feedback than used in previous work with similar objectives.
	By “simpler” and “more natural”, which are obviously subjective terms, we mean the following. Apart from stel- lar mass loss, we employ only one type of stellar feedback, which captures the collective effects of processes such as stellar winds, radiation pressure on dust grains, and su- pernovae. These and other feedback mechanisms are often implemented individually, but we believe they cannot be properly distinguished at the resolution of 102–103 pc that is currently typical for simulations that sample a represen- tative volume of the universe. Similarly, we employ only one type of AGN feedback (as opposed to e.g. both a “radio” and “quasar” mode). Contrary to most previous work, stel- lar (and AGN) feedback is injected in thermal form without turning off radiative cooling and without turning off hydro- dynamical forces. Hence, galactic winds are generated with- out specifying a wind direction, velocity, mass loading factor, or metal mass loading factor. We also do not need to boost the BH Bondi-Hoyle accretion rates by an ad-hoc factor. Fi- nally, the amount of feedback energy (and momentum) that is injected per unit stellar mass depends on local gas prop- erties rather than on non-local or non-baryonic properties such as the dark matter velocity dispersion or halo mass.
	The EAGLE suite includes many simulations that will be presented elsewhere. It includes higher-resolution simu- lations that zoom into individual galaxies or galaxy groups (e.g. Sawala et al. 2014a). It also includes variations in the numerical techniques (Schaller et al. 2014) and in the sub- grid models (Crain et al. 2014) that can be used to test the robustness of the predictions and to isolate the effects of individual processes.
	This paper is organised as follows. We begin in §2 with a discussion of the use and pitfalls of cosmological hydro- dynamical simulations in light of the critical role played by subgrid processes. We focus in particular on the implica- tions for the interpretation and the predictive power of the simulations, and the role of numerical convergence. In §3 we describe the simulations and our definition of a galaxy. This section also briefly discusses the numerical techniques and subgrid physics. The subgrid models are discussed in depth in §4; readers not interested in the details may wish to skip this section. In §5 we show the results for observables that were considered in the calibration of the subgrid models, namely the z ∼ 0 GSMF, the related relation between stellar mass and halo mass, galaxy sizes, and the relations between BH mass and stellar mass. We also consider the importance of the choice of aperture used to measure stellar masses and investigate both weak and strong convergence (terms that are defined in §2). In §6 we present a diverse and representa- tive set of predictions that were not used for the calibration, including specific star formation rates and passive fractions, the Tully-Fisher relation, the mass-metallicity relations, var-
	ious properties of the intracluster medium, and the column density distributions of intergalactic metals. All results pre- sented here are for z ∼ 0. We defer an investigation of the evolution to Furlong et al. (2014) and other future papers. We summarize and discuss our conclusions in §7. Finally, our implementation of the hydrodynamics and our method for generating the initial conditions are summarized in Ap- pendices A and B, respectively.
	2 IMPLICATIONS OF THE CRITICAL ROLE OF SUBGRID MODELS FOR FEEDBACK
	In this section we discuss what, in our view, the conse- quences of our reliance on subgrid models for feedback are for the predictive power of the simulations (§2.1) and for the role of numerical convergence (§2.2).

2.1 The need for calibration
Because the recent improvement in the match between sim- ulated and observed galaxies can, for the most part, be at- tributed to the implementation of more effective subgrid models for feedback, the success of the hydrodynamical sim- ulations is subject to two important caveats that are more commonly associated with semi-analytic models.
First, while it is clear that effective feedback is required, the simulations can only provide limited insight into the na- ture and source of the feedback processes. For example, sup- pose that the implemented subgrid model for supernovae is too inefficient because, for numerical reasons, too much of the energy is radiated away, too much of the momentum cancels out, or the energy/momentum are coupled to the gas at the wrong scale. If we were unaware of such numeri- cal problems, then we might erroneously conclude that ad- ditional feedback processes such as radiation pressure are required. The converse is, of course, also possible: the im- plemented feedback can also be too efficient, for example because the subgrid model underestimates the actual radia- tive losses. The risk of misinterpretation is real, because it can be shown that many simulations underestimate the ef- fectiveness of feedback due to excessive radiative losses (e.g. Dalla Vecchia & Schaye 2012), which themselves are caused by a lack of resolution and insufficiently realistic modelling of the ISM.
Second, the ab initio predictive power of the simula- tions is currently limited when it comes to the properties of galaxies. If the efficiency of the feedback processes de- pends on subgrid prescriptions that may not be good ap- proximations to the outcome of unresolved processes, or if the outcome depends on resolution, then the true efficiencies cannot be predicted from first principles. Note that the use of subgrid models does not in itself remove predictive power. If the physical processes that operate below the resolution limit and their connection with the physical conditions on larger scales are fully understood and can be modelled or observed, then it may be possible to create a subgrid model that is sufficiently realistic to retain full predictive power. However, this is currently not the case for feedback from star formation and AGN. As we shall explain below, this implies that simulations that appeal to a subgrid prescrip- tion for the generation of outflows are unable to predict the
stellar masses of galaxies. Similarly, for galaxies whose evolu- tion is controlled by AGN feedback, such simulations cannot predict the masses of their central BHs.
To illustrate this, it is helpful to consider a simple model. Let us assume that galaxy evolution is self-regulated, in the sense that galaxies tend to evolve towards a quasi- equilibrium state in which the gas outflow rate balances the difference between the gas inflow rate and the rate at which gas is locked up in stars and BHs. The mean rate of in- flow (e.g. in the form of cold streams) evolves with redshift and tracks the accretion rate of dark matter onto haloes, which is determined by the cosmological initial conditions. For simplicity, let us further assume that the outflow rate is large compared to the rate at which the gas is locked up. Although our conclusions do not depend on the validity of this last assumption, it simplifies the arguments because it implies that the outflow rate balances the inflow rate, when averaged over appropriate length and time scales. Note that the observed low efficiency of galaxy formation (see Fig. 8 in §5.2) suggests that this may actually be a reasonable ap- proximation, particularly for low-mass galaxies.
This toy model is obviously incorrect in detail. For ex- ample, it ignores the re-accretion of matter ejected by winds, the recycling of stellar mass loss, and the interaction of out- flows and inflows. However, recent numerical experiments and analytic models provide some support for the general idea (e.g. Finlator & Dav ́e 2008; Schaye et al. 2010; Booth & Schaye 2010; Dav ́e et al. 2012; Haas et al. 2013a,b; Feld- mann 2013; Dekel et al. 2013; Altay et al. 2013; Lilly et al. 2013; Sa ́nchez Almeida et al. 2014). This idea in itself is cer- tainly not new and follows from the existence of a feedback loop (e.g. White & Frenk 1991), as can be seen as follows. If the inflow rate exceeds the outflow rate, then the gas fraction will increase and this will in turn increase the star forma- tion rate (and/or, on a smaller scale, the BH accretion rate) and hence also the outflow rate. If, on the other hand, the outflow rate exceeds the inflow rate, then the gas fraction will decrease and this will in turn decrease the star forma- tion rate (and/or the BH accretion rate) and hence also the outflow rate.
In this self-regulated picture of galaxy evolution the out- flow rate is determined by the inflow rate. Hence, the outflow rate is not determined by the efficiency of the implemented feedback. Therefore, if the outflow is driven by feedback from star formation, then the star formation rate will adjust until the outflow rate balances the inflow rate, irrespective of the (nonzero) feedback efficiency. However, the star formation rate for which this balance is achieved, and hence also ulti- mately the stellar mass, do depend on the efficiency of the implemented feedback. If the true feedback efficiency cannot be predicted, then neither can the stellar mass. Similarly, if the outflow rate is driven by AGN feedback, then the BH accretion rate will adjust until the outflow rate balances the inflow rate (again averaged over appropriate length and time scales). The BH accretion rate, and hence the BH mass, for which this balance is achieved depend on the efficiency of the implemented feedback, which has to be assumed. Ac- cording to this toy model, which appears to be a reasonable description of the evolution of simulated galaxies, the stel- lar and BH masses are thus determined by the efficiencies of the (subgrid) implementations for stellar and AGN feed- back, respectively.
The simulations therefore need to be calibrated to pro- duce the correct stellar and BH masses. Moreover, if the true efficiency varies systematically with the physical conditions on a scale resolved by the simulations, then the implemented subgrid efficiency would also have to be a function of the lo- cal physical conditions in order to produce the correct mass functions of galaxies and BHs.
A similar story applies to the gas fractions of galaxies or, more precisely, for the amount of gas above the assumed star formation threshold, even if the simulations have been calibrated to produce the correct GSMF. We can see this as follows. If the outflow rate is determined by the inflow rate, then it is not determined by the assumed subgrid star formation law. Hence, if we modify the star formation law,2 then the mean outflow rate should remain unchanged. And if the outflow rate remains unchanged, then so must the star formation rate because for a fixed feedback efficiency the star formation rate will adjust to the rate required for outflows to balance inflows. If the star formation rate is independent of the star formation law, then the galaxies must adjust the amount of star-forming gas that they contain when the star formation law is changed.
Hence, to predict the correct amount of star-forming gas, we need to calibrate the subgrid model for star forma- tion to the observed star formation law. Fortunately, the star formation law is relatively well characterised observationally on the ∼ 102 − 103 pc scales resolved by large-volume simu- lations, although there are important unanswered questions, e.g. regarding the dependence on metallicity. Ultimately the star formation law must be predicted by simulations and will probably depend on the true efficiency of feedback pro- cesses within the ISM, but resolving such processes is not yet possible in simulations of cosmological volumes.
It is not obvious how the efficiency of feedback from star formation should be calibrated. We could choose to calibrate to observations of outflow rates relative to star formation rates. However, those outflow rates are highly uncertain and may be affected by AGN feedback. It is also unclear on what scale the outflow rate should be calibrated. In addition, the outflow velocity and the wind mass loading may be individu- ally important. Moreover, unless the interaction of the wind with the circumgalactic medium is modelled correctly and resolved, then obtaining a correct outflow rate on the scale used for the calibration does not necessarily imply that it is also correct for the other scales that matter.
We choose to calibrate the feedback efficiency using the observed present-day GSMF, as is also common practice for semi-analytic models. We do this mostly because it is rela- tively well constrained observationally and because obtain- ing the correct stellar mass - halo mass relation, and hence the correct GSMF if the cosmological initial conditions are known, is a pre-condition for many applications of cosmo- logical simulations. For example, the physical properties of the circumgalactic medium (CGM) are likely sensitive to the halo mass, but because halo mass is difficult to mea- sure, observations and simulations of the CGM are typically compared for galaxies of the same stellar mass.
One may wonder what the point of hydrodynamical simulations (or, indeed, semi-analytic models) is if they can- not predict stellar masses or BH masses. This is a valid question for which there are several answers. One is that the simulations can still make predictions for observables that were not used for the calibration, and we will present such predictions in §6 and in subsequent papers. However, which observables are unrelated is not always unambiguous. One way to proceed, and an excellent way to learn about the physics of galaxy formation, is to run multiple simula- tions with varying subgrid models. It is particularly useful to have multiple prescriptions calibrated to the same observ- ables. EAGLE comprises many variations, including several that reproduce the z ∼ 0 GSMF through different means (Crain et al. 2014).
A second answer is that making good use of simulations of galaxy formation does not necessarily mean making quan- titative predictions for observables of the galaxy population. We can use the simulations to gain insight into physical pro- cesses, to explore possible scenarios, and to make qualitative predictions. How does gas get into galaxies? What factors control the size of galaxies? What is the origin of scatter in galaxy scaling relations? What is the potential effect of outflows on cosmology using weak gravitational lensing or the Lyα forest? The list of interesting questions is nearly endless.
A third answer is that cosmological, hydrodynamical simulations can make robust, quantitative predictions for more diffuse components, such as the low-density IGM and perhaps the outer parts of clusters of galaxies.
A fourth answer is that calibrated simulations can be useful to guide the interpretation and planning of observa- tions, as the use of semi-analytic and halo models has clearly demonstrated. In this respect hydrodynamical simulations can provide more detailed information on both the galaxies and their gaseous environments. 2.2 Numerical convergence
The need to calibrate the efficiency of the feedback and the associated limits on the predictive power of the simulations call the role of numerical convergence into question. The conventional point of view is that subgrid models should be designed to yield numerically converged predictions. Conver- gence is clearly a necessary condition for predictive power. However, we have just concluded that current simulations cannot, in any case, make ab initio predictions for some of the most fundamental observables of the galaxy population.
While it is obvious that we should demand convergence for predictions that are relatively robust to the choice of subgrid model, e.g. the statistics of the Lyα forest, it is less obvious that the same is required for observables that de- pend strongly and directly on the efficiency of the subgrid feedback. One could argue that, instead, we only need con- vergence after recalibration of the subgrid model. We will call this “weak convergence”, as opposed to the “strong con- vergence” that is obtained if the results do not change with resolution when the model is held fixed.
If only weak convergence is required, then the demands placed on the subgrid model are much reduced, which has two advantages:
First, we can take better advantage of increases in res- olution. The subgrid scale can now move along with the res-
olution limit, so we can potentially model the physics more faithfully if we adopt higher resolution.
A second advantage of demanding only weak conver- gence is that we do not have to make the sacrifices that are required to improve the strong convergence and that might have undesirable consequences. We will provide three exam- ples of compromises that are commonly made.
Simulations that sample a representative volume cur- rently lack the resolution and the physics to predict the ra- diative losses to which outflows are subject within the ISM. Strong convergence can nevertheless be achieved if these losses are somehow removed altogether, for example, by tem- porarily turning off radiative cooling and calibrating the cri- terion for switching it back on (e.g. Gerritsen 1997; Stinson et al. 2006). However, it is then unclear for which gas the cooling should be switched off. Only the gas elements into which the subgrid feedback was directly injected? Or also the surrounding gas that is subsequently shock-heated?
Other ways to circumvent radiative losses in the ISM are to generate the outflow outside the galaxy or to turn off the hydrodynamic interaction between the wind and the ISM (e.g. Springel & Hernquist 2003; Oppenheimer & Dav ́e 2006; Oppenheimer et al. 2010; Puchwein & Springel 2013; Vogelsberger et al. 2013, 2014b). This is a valid choice, but one that eliminates the possibility of capturing any aspect of the feedback other than mass loss, such as puffing up of discs, blowing holes, driving turbulence, collimating out- flows, ejecting gas clouds, generating small-scale galactic fountains, etc. Furthermore, it necessarily introduces new parameters that control where the outflow is generated and when the hydrodynamics is turned back on. These param- eters may directly affect results of interest, including the state of gas around galaxies, and may also re-introduce res- olution effects. A potential solution to this problem is to never re-couple and hence to evaluate all wind interactions using a subgrid model, even outside the galaxies, as is done in semi-analytic models.
However, bypassing radiative losses in the ISM is not by itself sufficient to achieve strong convergence. In addi- tion, the feedback must not depend on physical conditions in the ISM since those are unlikely to be converged. Instead, one can make the feedback depend on properties defined by the dark matter, such as its local velocity dispersion or halo mass (e.g. Oppenheimer & Dav ́e 2006; Okamoto et al. 2010; Oppenheimer et al. 2010; Puchwein & Springel 2013; Vo- gelsberger et al. 2013, 2014b), which are generally better converged than the properties of the gas. As was the case for turning off cooling or hydrodynamic forces, this choice makes the simulations less “hydrodynamical”, moving them in the direction of more phenomenological approaches, and it also introduces new problems. How do we treat satellite galaxies given that their subhalo mass and dark matter ve- locity dispersion are affected by the host halo? Or worse, what about star clusters or tidal dwarf galaxies that are not hosted by dark matter haloes?
In practice, however, the distinction between weak and strong convergence is often unclear. One may surmise that keeping the physical model fixed is equivalent to keeping the code and subgrid parameters fixed (apart from the numer- ical parameters controlling the resolution), but this is not necessarily the case because of the reliance on subgrid pre- scriptions and the inability to resolve the first generations of stars and BHs. For typical subgrid prescriptions, the en- ergy, the mass, and the momentum involved in individual feedback events, and the number or intermittency of feed- back events do not all remain fixed when the resolution is changed. Any such changes could affect the efficiency of the feedback. Consider, for example, a star-forming region and assume that feedback energy from young stars is distributed locally at every time step. If the resolution is increased, then the time step and the particle mass will become smaller. If the total star formation rate remains the same, then the feedback energy that is injected per time step will be smaller because of the decrease in the time step. If the gas mass also remains the same, then the temperature increase per time step will be smaller. A lower post-feedback temperature of- ten leads to larger thermal losses. If, instead, the subgrid model specifies the temperature jump (or wind velocity), then the post-feedback temperature will remain the same when the resolution is increased, but the number of heating events will increase because the same amount of feedback en- ergy has to be distributed over lower-mass particles. There is no guarantee that more frequent, lower-energy events drive the same outflows as less frequent, higher-energy events.
Moreover, for cosmological initial conditions, higher res- olution implies resolving smaller haloes, and hence tracing the progenitors of present-day galaxies to higher redshifts. If these progenitors drive winds, then this may impact the subsequent evolution.
In §5.1 we investigate both the weak and strong con- vergence of our simulations, focusing on the GSMF. We test the weak convergence for a wide variety of predictions in sections 5 and 6. 

3 SIMULATIONS
EAGLE was run using a modified version of the N-Body Tree-PM smoothed particle hydrodynamics (SPH) code gadget 3, which was last described in Springel (2005). The main modifications are the formulation of SPH, the time stepping and, most importantly, the subgrid physics.
The subgrid physics used in EAGLE is based on that developed for OWLS (Schaye et al. 2010), and used also in GIMIC (Crain et al. 2009) and cosmo-OWLS (Le Brun et al. 2014). We include element-by-element radiative cooling for 11 elements, star formation, stellar mass loss, energy feed- back from star formation, gas accretion onto and mergers of supermassive black holes (BHs), and AGN feedback. As we will detail in §4, we made a number of changes with respect to OWLS. The most important changes concern the imple- mentations of energy feedback from star formation (which is now thermal rather than kinetic), the accretion of gas onto BHs (which now accounts for angular momentum), and the star formation law (which now depends on metallicity). 

In the simulations presented here the amount of feed- back energy that is injected per unit stellar mass decreases with the metallicity and increases with the gas density. It is bounded between one third and three times the energy provided by supernovae and, on average, it is about equal to that amount. The metallicity dependence is motivated by the fact that we expect greater (unresolved) thermal losses when the metallicity exceeds ∼ 10−1 Z⊙, the value for which metal-line cooling becomes important. The density depen- dence compensates for spurious, numerical radiative losses which, as expected, are still present at our resolution even though they are greatly reduced by the use of the stochastic prescription of Dalla Vecchia & Schaye (2012). The simula- tions were calibrated against observational data by running a series of high-resolution 12.5 cMpc and intermediate reso- lution 25 cMpc test runs with somewhat different dependen- cies on metallicity and particularly density. From the models that predicted reasonable physical sizes for disc galaxies, we selected the one that best fit the z ∼ 0 GSMF. For more details on the subgrid model for energy feedback from star formation we refer the reader to §4.5.

As described in more detail in Appendix A, we make use of the conservative pressure-entropy formulation of SPH de- rived by Hopkins (2013), the artificial viscosity switch from Cullen & Dehnen (2010), an artificial conduction switch similar to that of Price (2008), the C2 Wendland (1995) kernel and the time step limiters of Durier & Dalla Vec- chia (2012). We will refer to these numerical methods col- lectively as “Anarchy”. Anarchy will be described in more detail by Dalla Vecchia (in preparation), who also demon- strates its good performance on standard hydrodynamical tests (see Hu et al. 2014 for tests of a similar set of meth- ods). In Schaller et al. (2014) we will show the relevance of the new hydrodynamical techniques and time stepping scheme for the results of the EAGLE simulations. Although the Anarchy implementation yields dramatic improvements in the performance on some standard hydrodynamical tests as compared to the original implementation of the hydrody- namics in gadget 3, we generally find that the impact on the results of the cosmological simulations is small compared to those resulting from reasonable variations in the subgrid physics (see also Scannapieco et al. 2012).

The values of the cosmological parameters used for the EAGLE simulations are taken from the most recent Planck results (Planck Collaboration 2013, Table 9) and are listed in Table 1. A transfer function with these parameters was generated using CAMB (Lewis et al. 2000, version Jan 12). The linear matter power spectrum was generated by multi- plying a power-law primordial power spectrum with an in- dex of ns = 0.9611 by the square of the dark matter transfer function evaluated at redshift zero3. Particles arranged in a glass-like initial configuration were displaced accord- ing to 2nd-order Lagrangian perturbation theory using the method of Jenkins (2010) and the public Gaussian white noise field Panphasia (Jenkins 2013; Jenkins & Booth 2013). The methods used to generate the initial conditions are de- scribed in detail in Appendix B.
Table 2 lists box sizes and resolutions of the main EA- GLE simulations. All simulations were run to redshift z = 0. Note that contrary to convention, box sizes, particles masses and gravitational softening lengths are not quoted in units of h−1. The gravitational softening was kept fixed in comov- ing units down to z = 2.8 and in proper units thereafter. We will refer to simulations with the same mass and spatial res- olution as L100N1504 as intermediate resolution runs and to simulations with the same resolution as L025N0752 as high-resolution runs. Particle properties were recorded for 29 snapshots be- tween redshifts 20 and 0. In addition, we saved a reduced set of particle properties (“snipshots”) at 400 redshifts between 20 and 0. The largest simulation, L100N1504, took about 4.5 M CPU hours to reach z = 0 on a machine with 32 TB of memory, with the EAGLE subgrid physics typically tak- ing less than 25 per cent of the CPU time. The resolution of EAGLE suffices to marginally resolve
the Jeans scales in the warm ISM. The Jeans mass and
length for a cloud with gas fraction, fg, are, respectively,
Table 3. Values of the subgrid parameters that vary between the models presented here. The parameters nH,0 and nn control, re- spectively, the characteristic density and the power-law slope of the density dependence of the energy feedback from star forma- tion (see equation 7 in §4.5.1). The parameter Cvisc controls the sensitivity of the BH accretion rate to the angular momentum of the gas (see equation 9 in §4.6.2) and ∆TAGN is the temperature increase of the gas during AGN feedback (see §4.6.4).
 Prefix
Ref Recal AGNdT9
nn 0.67 2/ln10
Cvisc ∆TAGN (K)
2π 108.5 2π × 103 109 2π × 102 109
nH,0 (cm−3 )
 0.25 1/ ln 10 0.67 2/ ln 10 MJ ≈ 1×10 M⊙ fg (nH/10 cm ) (T/10 K) and LJ ≈2kpcfg (nH/10 cm ) (T/10K) ,where nH and T are the total hydrogen number density and the temperature, respectively. These Jeans scales can be com- pared to the gas particle masses and maximum proper grav- itational softening lengths listed in columns 4 and 7 of Ta-
ble 2. Simulations with the same subgrid physics and numer-
ical techniques as used for L100N1504 were carried out for all box sizes (12.5 – 100 cMpc) and particles numbers (1883 – 15043). We will refer to this physical model as the ref- erence model and will indicate the corresponding simula- tions with the prefix “Ref-” (e.g. Ref-L100N1504). As de- tailed in §4, we re-ran the high-resolution simulations with recalibrated parameter values for the subgrid stellar and AGN feedback to improve the match to the observed z ∼ 0 GSMF. We will use the prefix “Recal-” when referring to the simulations with this alternative set of subgrid parameters (e.g. Recal-L025N0752). Note that in terms of weak con- vergence, Ref-L100N1504 is more similar to model Recal- L025N0752 than to model Ref-L025N0752 (see §2.2 for a discussion of weak and strong convergence). In addition, we repeated the L050N0752 run with adjusted AGN pa- rameters in order to further improve the agreement with observations for high-mass galaxies. We will refer to this model with the prefix “AGNdT9”. Table 3 summarizes the values of the four subgrid parameters that vary between the models presented here. Crain et al. (2014) and Schaller et al. (2014) will present the remaining EAGLE simula- tions, which concern variations in the subgrid physics and the numerical techniques, respectively. Finally, Sawala et al. (2014a) present very high-resolution zoomed simulations of Local Group like systems run with the EAGLE code and a physical model that is nearly identical to the one used for the Ref-L100N1504 model described here. Figure 1 illustrates the large dynamic range of EA- GLE. It shows the large-scale gas distribution in a thick slice through the z = 0 output of the Ref-L100N1504 run, colour-coded by the gas temperature. The insets zoom in on an individual galaxy. The first zoom shows the gas, but the last zoom shows the stellar light after account- ing for dust extinction. This image was created using three monochromatic radiative transfer simulations with the code skirt (Baes et al. 2011) at the effective wavelengths of the Sloan Digital Sky Survey (SDSS) u, g & r filters. Dust ex- tinction is implemented using the metal distribution pre- dicted by the simulations and assuming that 30 per cent of the metal mass is locked up in dust grains. Only mate- rial within a spherical aperture with a radius of 30 pkpc is included in the radiative transfer calculation. More exam- ples of skirt images of galaxies are shown in Figure 2, in
  


	</body>

</paper>